"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_copilot-chat_components_Chat_tsx"],{19002:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(74848),s=r(38621),i=r(55847),a=r(76206),o=r(47050),l=r(20458);function c(){let{mode:e}=(0,o.Pk)(),t=(0,l.b)();return(0,n.jsx)(i.Q,{leadingVisual:s.ArrowLeftIcon,variant:"invisible",onClick:()=>(0,a.s0)(t.showTopicPicker,e),sx:{color:"fg.muted",marginLeft:"assistive"===e?"-8px":void 0},children:"All repositories"})}try{c.displayName||(c.displayName="AllTopicsButton")}catch{}},24089:(e,t,r)=>{r.d(t,{r:()=>eV});var n=r(74848),s=r(51848),i=r(38621),a=r(82678),o=r(75177),l=r(38553),c=r(55847),d=r(84217),u=r(52464),p=r(30729),h=r(96540),x=r(76206),m=r(57938),g=r(88365),f=r(47050),b=r(20458),y=r(92240),j=r(92836),v=r(51012),w=r(76049),A=r(61043),k=r(87330),S=r(25962),C=r(48962),I=r(13369),N=r(18754),T=r(69167);let R={"fade-in-duration":"InputTip-module__fade-in-duration--Go6O6"},z=()=>{let e=(0,h.useMemo)(()=>{let e=["Shift + Enter for new line","Type / for commands","Type @ for extensions","\u2191/\u2193 to cycle previous inputs"];return e[Math.floor(Math.random()*e.length)]},[]);return(0,n.jsx)("p",{className:`hide-sm mb-0 f6 fgColor-muted pointer-none anim-fade-in ${R["fade-in-duration"]}`,children:e})};try{z.displayName||(z.displayName="InputTip")}catch{}var W=r(94718),E=r(52057);let L=e=>{let t=(0,f.Pk)(),r=(0,b.b)(),s=(0,I.c)(),{selectedThreadID:i}=t,a=g.J.getSavedMessage(i),[l,u]=(0,h.useState)(a??""),[p,k]=(0,h.useState)(!1),R=(0,j.X)(["mac"]),L=(0,h.useRef)(null),G=e.textAreaRef||L,$=(0,h.useRef)(null),F=(0,h.useRef)(null),_=t.messages.filter(e=>"user"===e.role),B=(0,h.useRef)(0),U=m.W.copilotImmersiveV1&&"immersive"===t.mode,O=t.knowledgeBases.length>0,H=(0,h.useCallback)(async()=>{t.renderAttachKnowledgeBaseHerePopover&&await r.fetchKnowledgeBases()},[r,t.renderAttachKnowledgeBaseHerePopover]);(0,h.useEffect)(()=>{H()},[H]);let K=e=>R?e.metaKey:e.ctrlKey;(0,h.useEffect)(()=>{(async function(){let e=t.currentTopic;e&&(0,x.Z6)(e)&&void 0!==t.currentTopic&&await s.fetchAutocompleteSuggestions(e,"")})()},[s,t.currentTopic]),(0,h.useEffect)(()=>{g.J.setSavedMessage(i,l)},[i,l]),(0,v.N)(()=>{let e=0;!function t(){if(!G.current||!F.current||!$.current)return;e++,0===G.current.scrollHeight&&e<10&&setTimeout(t,1),G.current.style.height="0";let r=G.current.scrollHeight,n=Math.min(r,300);$.current.style.height=`${r}px`,G.current.style.height=`${r}px`,F.current.style.height=`${n}px`}()},[l,G,$]);let V=async e=>{k(!0),"Enter"!==e.key||e.shiftKey||e.ctrlKey||e.altKey||e.nativeEvent.isComposing?K(e)&&e.shiftKey&&"s"===e.key?(e.preventDefault(),await r.sendMessageToNewThread(i,l,t.currentReferences,t.context)):"ArrowUp"===e.key&&G.current&&(""===G.current.value||B.current>0)&&0===G.current.selectionStart&&_?.length>B.current?(e.preventDefault(),B.current++,u(_[_.length-B.current].content||"")):"ArrowDown"===e.key&&B.current>0&&G.current&&G.current.selectionStart===G.current.value.length&&(e.preventDefault(),B.current--,0===B.current?u(""):u(_[_.length-B.current].content||"")):(e.preventDefault(),await Q()),q()},q=(0,h.useCallback)(()=>{G?.current&&$?.current&&F?.current&&($.current.scrollTop=G.current.scrollTop,$.current.scrollLeft=G.current.scrollLeft)},[G]),Q=async n=>{if(k(!1),t.defaultRecipient&&!l.includes(`@${t.defaultRecipient}`)&&(t.defaultRecipient=void 0),n?.preventDefault(),await (0,C.yO)(l,t,r)){"/new"===l.trim()&&g.J.setSavedMessageFast(i,null),u("");return}if(e.isLoading)e.onAbort?.();else{if(!l)return;u(""),await e.onSubmit?.(l)}},Y=(0,h.useCallback)(e=>{k(!0),G?.current&&(u(e.target.value),B.current=0,q())},[q,G]),J=t.currentTopic&&(0,x.Z6)(t.currentTopic),Z=t.renderKnowledgeBases&&(t.currentTopic&&(0,x.Z6)(t.currentTopic)||!t.currentTopic),X=l.length<3,ee=e.isLoading?`Copilot is responding\u{2026}`:t.defaultRecipient?void 0:"Ask Copilot";return t.defaultRecipient&&""===l&&!p&&u(`@${t.defaultRecipient} `),(0,n.jsxs)("div",{children:[(0,n.jsx)(w.A,{open:Z&&O&&t.renderAttachKnowledgeBaseHerePopover,sx:{bottom:"57px"},caret:"bottom-left",children:(0,n.jsxs)(w.A.Content,{sx:{mt:2,width:"300px"},className:"color-shadow-medium",children:[(0,n.jsx)(d.A,{as:"h4",sx:{fontSize:2,mb:2},children:"An organization has shared a knowledge base with you"}),(0,n.jsx)("p",{children:"Select a knowledge base to chat with Copilot and get answers from Markdown documentation stored in GitHub."}),(0,n.jsx)(c.Q,{onClick:()=>{r.dismissAttachKnowledgeBaseHerePopover()},children:"Got it"})]})}),(0,n.jsxs)(o.A,{className:"copilot-chat-input",...(0,y.G)("copilot-chat-input"),sx:{position:"relative",width:"100%",overflow:"hidden",display:"flex",backgroundColor:"canvas.default",border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:"var(--borderRadius-medium)","> div":{flex:1},":focus-within .copilot-keyboard-shortcuts":{opacity:1,visibility:"visible"},":has(textarea:focus)":{outline:"2px solid var(--focus-outlineColor, var(--color-accent-emphasis))",borderColor:"transparent"}},children:[(0,n.jsxs)("div",{className:"d-flex position-absolute",style:{left:8,bottom:8},children:[Z&&(m.W.magicKBs?(0,n.jsx)(W.I8,{}):(0,n.jsx)(W.pV,{panelWidth:e.panelWidth})),J&&!m.W.magicKBs&&(0,n.jsx)(E.J,{panelWidth:e.panelWidth}),(0,n.jsx)(N.Q,{text:l,setText:u,textAreaRef:G})]}),(0,n.jsxs)(o.A,{as:"form",onSubmit:Q,className:"width-full d-flex flex-column gap-2",sx:{".copilot-chat-textarea::placeholder":{userSelect:"none"}},children:[(0,n.jsxs)(o.A,{ref:F,sx:{maxHeight:"30dvh",overflowY:"auto",flexGrow:1,position:"relative","> div":{display:"block"}},children:[(0,n.jsx)(T.j,{textAreaRef:G,children:(0,n.jsx)(A.Ay,{id:S.wg,className:"copilot-chat-textarea",autoComplete:"off",autoCorrect:"off",spellCheck:"false",role:"textbox","aria-multiline":"true",block:!0,ref:G,resize:"none",onKeyDown:V,onScroll:q,onInput:Y,placeholder:ee,value:l,sx:{border:"none",borderRadius:0,borderTopLeftRadius:"var(--borderRadius-medium)",borderTopRightRadius:"var(--borderRadius-medium)",display:"contents","> textarea":{position:"absolute",top:0,left:0,padding:"8px 12px 2px",background:"transparent",color:"transparent",caretColor:"var(--fgColor-default, var(--color-fg-default))",overflowY:"hidden",verticalAlign:"middle",resize:"none",zIndex:1},":focus-within":{boxShadow:"none"}}})}),(0,n.jsx)(D,{messages:t.messages,text:l,textareaPreviewRef:$,agents:t.agents,agentsPath:t.agentsPath})]}),(0,n.jsxs)("div",{className:"d-flex flex-items-center flex-justify-end gap-2 px-2 pb-2",children:[X&&!U&&(0,n.jsx)(z,{}),e.isStreaming?(0,n.jsx)(M,{onSubmit:()=>t.streamer&&r.stopStreaming(t.streamingMessage,t.streamer)}):(0,n.jsx)(P,{isLoading:e.isLoading,onSubmit:Q})]})]})]})]})};function D({messages:e,text:t,textareaPreviewRef:r,agents:s,agentsPath:i}){let a=(0,b.b)(),[l,c]=(0,h.useState)(""),[d,u]=(0,h.useState)("");return(0,h.useEffect)(()=>{if(!r.current)return;let n=t.match(/^@\S+/g);if(n&&n.length>0){let r;if(!s){i&&a.fetchAgents(i);return}if(0===s.length)return;let o=(0,x.Q7)(e);if(o.length>0){let e=o[0];r=s.filter(t=>t.slug===e.name)}else r=s;let l=n[0],d=l.substring(1);if(r.find(e=>e.slug===d)){c(l),u(t.replace(l,""));return}}c(""),u("")},[s,i,a,e,t,r]),(0,n.jsx)(o.A,{id:"copilot-chat-textarea-preview","aria-hidden":!0,className:"textarea-preview",ref:r,role:"presentation",sx:{bg:"canvas.default",borderRadius:"var(--borderRadius-medium) var(--borderRadius-medium) 0 0",height:"inherit",lineHeight:"20px",overflowY:"hidden",padding:"8px 12px 2px",position:"absolute",inset:0,whiteSpace:"pre-wrap",zIndex:0,"> .chat-token":{backgroundColor:"var(--bgColor-accent-muted, var(--color-accent-subtle))",borderRadius:"var(--borderRadius-small)",color:"var(--fgColor-accent, var(--color-accent-fg))"}},children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"chat-token",children:l}),d]}):t})}function P({isLoading:e,onSubmit:t}){return(0,n.jsx)(k.K,{variant:"invisible",size:"small",onClick:t,icon:i.PaperAirplaneIcon,"aria-label":"Send now",disabled:e,tooltipDirection:"n"})}function M({onSubmit:e}){return(0,n.jsx)(k.K,{variant:"invisible",size:"small",unsafeDisableTooltip:!0,onClick:e,icon:i.SquareFillIcon,"aria-label":"Stop response",tooltipDirection:"w"})}try{L.displayName||(L.displayName="ChatInput")}catch{}try{D.displayName||(D.displayName="TextareaPreview")}catch{}try{P.displayName||(P.displayName="SubmitButton")}catch{}try{M.displayName||(M.displayName="StopButton")}catch{}var G=r(7572),$=r(30569),F=r(22868),_=r(72574),B=r(92979),U=r(89169),O=r(16823),H=r(65481),K=r(20053),V=r(36305),q=r(72431),Q=r(695),Y=r(3167),J=r(85139),Z=r(84252),X=r(23398),ee=r(10452),et=r(35978),er=r(21176),en=r(4462),es=r(85414),ei=r(98264);let ea=({children:e})=>{let t=`
    @keyframes dot1 {
      0%, 75% { opacity: 1; }
      100% { opacity: 0; }
    }
    @keyframes dot2 {
      0% { opacity: 0; }
      15% { opacity: 0; }
      25%, 75% { opacity: 1; }
      100% { opacity: 0; }
    }
    @keyframes dot3 {
      0% { opacity: 0; }
      40% { opacity: 0; }
      50%, 75% { opacity: 1; }
      100% { opacity: 0; }
    }
  `;return(0,n.jsxs)(n.Fragment,{children:[e,(0,n.jsx)("style",{children:t}),[1,2,3].map(e=>(0,n.jsx)(u.A,{sx:{opacity:0,animation:"2s infinite",animationName:`dot${e}`},children:"."},`dot${e}`))]})};try{ea.displayName||(ea.displayName="WithAnimatedEllipsis")}catch{}let eo={"agent-mention":{regex:/^@\S+/g,renderer:e=>(0,n.jsx)(es.$,{mention:e})}},el=({isLatestMessage:e,isStreaming:t,panelWidth:r,...s})=>{let i=(0,f.Pk)(),l=(0,b.b)(),{message:c}=(0,Q.V)(),d=(0,x.Th)(c,i.currentUserLogin),g="Copilot"===d.name,y="user"===d.type,j=g||(0,x.yh)(d),v=g&&c.agentErrors?.length,w=!v&&!!g&&!!c.error&&c.error.isError,A=new Date(Date.parse(c.createdAt||"")),k=s.isLoading||t,S=g&&!s.excludeFeedback&&!k,C=(0,h.useRef)([]),I=(0,h.useRef)(null),N=function(){let{currentTopic:e}=(0,f.Pk)(),t=(0,h.useSyncExternalStore)(()=>()=>{},()=>location.origin,()=>"");if(!(0,x.P)(e))return"";let{name:r,id:n}=e;return`

---

Generated by Copilot using the [${r}](${t}/copilot/d/${n}) knowledge base`}(),T=(0,h.useRef)(!1),R=(0,h.useRef)(null),z=c.interrupted,W=c.clientConfirmations&&c.clientConfirmations.length>0,E=m.W.copilotImmersiveV1&&"immersive"===i.mode,[L,D]=(0,h.useState)([]),[P,M]=(0,h.useState)(void 0),[es,el]=(0,h.useState)([]),ec=!w&&(S||g&&!!c.content&&!t&&m.W.copyMessage)&&!c.confirmations,eu=(0,h.useCallback)(async()=>i.agentsPath?await l.fetchAgents(i.agentsPath):[],[l,i.agentsPath]),{content:ex,reactReplaceMatches:em}=(0,h.useMemo)(()=>{if(m.W.reactMarkdown){let{output:e,matches:t}=(0,ei.s0)(eo,c.id,c.content);return{content:e,reactReplaceMatches:t}}return{content:c.content,reactReplaceMatches:[]}},[c.content,c.id]),{html:eg,hasCitations:ef,referenceMap:eb}=(0,h.useMemo)(()=>g&&"ask-docs"===c.intent?(0,V.oo)(ex,c.references,"assistive"===i.mode,i.agents,eu):m.W.vulnerabilityAnnotations?{html:(0,V.IA)(ex,c.references,c.copilotAnnotations,"assistive"===i.mode,i.agents,eu),hasCitations:!1,referenceMap:null}:{html:(0,V.Kc)(ex,c.references,[],"assistive"===i.mode,i.agents,eu),hasCitations:!1,referenceMap:null},[g,c.intent,ex,c.references,c.copilotAnnotations,i.mode,i.agents,eu]),ey=!!(g&&s.isLoading||eg||c.references?.length||c.confirmations?.length||c.skillExecutions?.length||w||v);(0,a.G)({containerRef:I,bindKeys:128,focusableElementFilter:e=>(T.current||C.current.includes(e)||e.classList.contains("reference-action")||C.current.push(e),!0),getNextFocusable:(e,t)=>{let r=C.current.indexOf(t);if("next"===e){if(r+2>C.current.length)return s.setParentFocusZoneEnabled?.(!0),t?.setAttribute("tabindex","-1"),C.current[0]?.setAttribute("tabindex","0"),s.inputRef?.current||void 0;if(s.setParentFocusZoneEnabled?.(!1),-1!==r)return C.current[r+1]}if("previous"===e&&(1===r&&s.setParentFocusZoneEnabled?.(!0),r>0))return C.current[r-1]}},[]),(0,h.useEffect)(()=>{e&&t&&(0,G.i)("Copilot is responding")},[e,t]),(0,h.useEffect)(()=>{e&&!t&&I.current&&(0,G.C)(I.current)},[e,t]),(0,h.useEffect)(()=>{if(!m.W.newReferencesUI)return;let e=(c.skillExecutions??[]).find(e=>!L.some(t=>t.slug===e.slug));e&&(D([...L,e]),M(e))},[c.skillExecutions,L]),(0,h.useEffect)(()=>{if(!m.W.newReferencesUI)return;let e=(c.skillExecutions??[]).filter(e=>"completed"===e.status&&e.references&&e.references.length>0&&!es.some(t=>e.slug===t.slug));e.length>0&&el([...es,...e])},[es,c.skillExecutions]);let ej=(0,h.useCallback)(()=>{C.current=C.current.filter(e=>!e.classList.contains("feedback-action")),T.current=!0},[]),ev=(0,h.useCallback)(async(e,t)=>{await l.sendChatMessage(l.getSelectedThread(i),`@${d.name} ${eh(e.state)} Confirmation: ${t}`,c.references??[],i.currentTopic,i.context,e)},[l,i,d.name,c.references]),ew=(0,h.useCallback)(e=>{let t=e.target.href,r=c.references?.find(e=>e.url===t);r&&"immersive"===i.mode&&(l.selectReference(r),e.preventDefault())},[l,c.references,i.mode]),eA=(0,h.useCallback)(e=>{let t=e.target;if(t.open&&R.current){let e=t.querySelectorAll(".reference-action"),r=C.current.indexOf(R.current);r>=0&&(C.current=[...C.current.slice(0,r+1),...e,...C.current.slice(r+1)])}else C.current=C.current.filter(e=>!e.classList.contains("reference-action"))},[]),ek="immersive"===i.mode?"var(--bgColor-default, var(--color-canvas-default))":"var(--overlay-bgColor, var(--color-canvas-overlay, #161b22))";return(0,n.jsxs)(o.A,{className:"message-container",tabIndex:0,ref:I,sx:{p:3,borderBottom:"assistive"!==i.mode||e?"none":"1px solid var(--borderColor-muted, var(--color-border-muted))",fontSize:1,borderRadius:E&&!j?2:0,marginTop:E?3:0,backgroundColor:E&&!j?"var(--bgColor-inset)":"",width:E&&!j?"66%":"100%",alignSelf:E&&!j?"end":"",position:E?"relative":"static","&:hover, &:focus-within":{".message-actions":{opacity:1,pointerEvents:"auto"}},"&:hover":{".message-actions":{transition:"opacity 0.1s ease-in-out",transitionDelay:"0.2s"}}},children:[!E||j?(0,n.jsxs)(o.A,{as:E?"div":"h2",sx:{width:"100%",display:"flex",alignItems:"center",gap:2,fontSize:1,marginBottom:m.W.newReferencesUI&&c.references&&!k?1:2},children:[g?(0,n.jsx)(X.A,{isLoading:k,isError:w&&c.error?.type!=="agentUnauthorized",mode:i.mode}):(!E||j)&&(0,n.jsx)(o.A,{sx:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)(F.r,{src:d.avatarURL,size:24})}),(0,n.jsx)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexGrow:1},children:(0,n.jsxs)(o.A,{sx:{display:"flex",gap:2,alignItems:"baseline"},children:[E?null:(0,n.jsx)(u.A,{"data-testid":"chat-message-author-name",sx:{fontWeight:"bold"},children:d.name}),W&&(0,n.jsxs)(u.A,{sx:{fontWeight:"normal"},children:[c.clientConfirmations?.[0]?.state," the action"]}),!E&&(0,n.jsx)(u.A,{sx:{fontSize:0,fontWeight:400,color:"fg.subtle"},children:g&&k?m.W.newReferencesUI?(0,n.jsx)(ea,{children:(0,en.WA)(P)}):"Responding...":(0,n.jsx)(U.A,{date:A,format:"relative"})})]})})]}):null,m.W.newReferencesUI&&g&&k&&es.length>0&&(0,n.jsx)(O.l,{children:es.map((e,t)=>{let r=(0,en.gB)(e);if(r)return(0,n.jsxs)(O.l.Item,{sx:{fontSize:1},children:[(0,n.jsx)(O.l.LeadingVisual,{children:(0,n.jsx)(p.A,{icon:r.icon})}),r.loadingText]},t)})}),ey&&(0,n.jsxs)("div",{className:(0,K.$)(q.A.message),children:[(0,n.jsxs)(o.A,{className:"js-snippet-clipboard-copy-unpositioned",sx:{".snippet-clipboard-content":{position:"relative",overflow:"auto",display:"flex",justifyContent:"space-between",backgroundColor:"canvas.subtle",marginBottom:3,pre:{marginBottom:0},zIndex:1,"clipboard-copy":{width:"28px",height:"28px"}}},children:[!m.W.newReferencesUI&&g&&c.skillExecutions?.map((e,t)=>n.jsx(er.C,{functionCall:e,manager:l,panelWidth:r},t)),m.W.newReferencesUI&&(y||"assistant"===c.role)&&(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)(Y.n,{references:c.references??[],referenceMap:eb,showReferenceNumbers:ef,onToggle:eA,summaryRef:R})}),g&&s.isLoading?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(B.O,{variant:"rounded",height:"12px",width:"random"}),(0,n.jsx)(B.O,{variant:"rounded",height:"12px",width:"random"}),(0,n.jsx)(B.O,{variant:"rounded",height:"12px",width:"random"})]}):m.W.reactMarkdown&&!W?(0,n.jsx)(ei.aF,{onLinkClick:ew,body:eg,matches:em,reactReplaceBlocks:eo}):!W&&(0,n.jsx)(_.G,{onLinkClick:ew,verifiedHTML:eg}),!m.W.newReferencesUI&&(y||"assistant"===c.role)&&(0,n.jsx)(Y.n,{references:c.references??[],referenceMap:eb,showReferenceNumbers:ef,onToggle:eA,summaryRef:R}),w?(0,n.jsx)(ed,{manager:l}):null,c.agentErrors?.length?(0,n.jsx)(ep,{errors:c.agentErrors}):null,z?(0,n.jsx)(H.A,{"data-testid":"chat-message-interrupted",sx:{fontSize:1,px:2,py:1,zIndex:-1},children:"Copilot was interrupted before it could finish this message."}):null,(g||(0,x.yh)(d))&&(0,x.Ye)(c.confirmations).map((t,r)=>"indexrepo"===t.confirmation.name?(0,n.jsx)(J.R,{confirmation:t},r):(0,n.jsx)(Z.m,{confirmation:t,handleConfirmation:ev,isLatestMessage:e},r))]}),e&&ec&&m.W.followUpThreadSuggestions&&(0,n.jsx)(ee.A,{panelWidth:r}),ec&&(0,n.jsxs)(o.A,{className:"message-actions",sx:{display:"inline-flex",alignItems:"center",position:e?void 0:"absolute",bottom:e?void 0:"-2.25rem",backgroundColor:ek,borderRadius:e?void 0:2,boxShadow:e?void 0:"var(--shadow-floating-small)",opacity:e?void 0:0,pointerEvents:e?void 0:"none","&::before":{content:e?void 0:'""',inset:"-0.5rem -0.75rem",zIndex:-1,position:"absolute"}},children:[S&&(0,n.jsx)(et.G,{returnFocusRef:I,setParentFocusZoneEnabled:s.setParentFocusZoneEnabled,onFeedbackSubmitted:ej}),g&&!!c.content&&!t&&m.W.copyMessage&&(0,n.jsx)($.T,{textToCopy:(c.content??"")+N,ariaLabel:"Copy to clipboard",size:"small",className:"d-flex flex-items-center"})]})]})]})},ec=({message:e,...t})=>(0,n.jsx)(Q.$,{message:e,children:(0,n.jsx)(el,{...t})});function ed({manager:e}){let{message:t}=(0,Q.V)(),{error:r}=t;if(!r)return null;switch(r.type){case"agentUnauthorized":return(0,n.jsx)(eu,{error:r,manager:e});case"agentRequest":return(0,n.jsx)(ep,{errors:[r.details]});default:return(0,n.jsx)(H.A,{variant:"warning",sx:{fontSize:1,px:2,py:1,zIndex:-1},children:r.message||"Something went wrong"})}}function eu({error:e,manager:t}){let{details:r}=e,[s,a]=(0,h.useState)(!1),o=(0,h.useCallback)(()=>{a(!0),t.dispatch({type:"MESSAGE_ADDED",message:(0,x.Y6)({role:"user",content:`Dismissed the connection with ${r.name}.`})}),t.dispatch({type:"MESSAGE_ADDED",message:(0,x.Y6)({role:"assistant",content:`I was unable to connect you to ${r.name} because you cancelled the authentication.`})})},[r.name,t]);return(0,n.jsxs)("div",{className:"position-relative d-flex flex-column flex-items-center gap-3 border rounded-2 p-5",children:[!s&&(0,n.jsx)(k.K,{"aria-label":"Close",className:"position-absolute top-0 right-0 mt-2 mr-2",icon:i.XIcon,onClick:o,variant:"invisible",unsafeDisableTooltip:!0}),(0,n.jsxs)("div",{className:"d-flex flex-items-center gap-2",children:[(0,n.jsx)(i.MarkGithubIcon,{size:48,className:"border circle borderColor-muted"}),(0,n.jsx)(i.LinkIcon,{className:"fgColor-muted"}),(0,n.jsx)("img",{className:(0,K.$)("avatar",q.A.agentUnauthorizedAvatar,"border circle borderColor-muted"),src:r.avatar_url,alt:`icon for ${r.name}`})]}),(0,n.jsxs)("p",{className:"h4 m-0 text-center",children:["Connect with ",r.name]}),(0,n.jsxs)("p",{className:"fgColor-muted text-center",children:["To use the ",r.name," extension, you\u2019ll need to connect your GitHub account to your ",r.name," account."]}),!s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Q,{as:"a",variant:"primary",size:"large",className:"width-full",href:r.authorize_url,rel:"noopener",target:"_blank",children:"Connect"}),(0,n.jsxs)("p",{className:"fgColor-muted text-center f6 m-0",children:["Click connect to be redirected to ",r.authorize_url]})]})]})}function ep({errors:e}){return(0,n.jsx)("div",{className:"d-flex flex-column gap-2",children:e.map((e,t)=>(0,n.jsxs)("div",{className:"p-3 border rounded-2",children:[(0,n.jsxs)("div",{className:"text-bold",children:[(0,n.jsx)(i.AlertFillIcon,{className:"mr-1 fgColor-attention"})," ","http"===e.type?`${e.code} ${e.identifier}`:`${eh(e.type)} error`]}),(0,n.jsx)("div",{children:e.message})]},t))})}function eh(e){return e.charAt(0).toUpperCase()+e.slice(1)}try{el.displayName||(el.displayName="InnerChatMessage")}catch{}try{ec.displayName||(ec.displayName="ChatMessage")}catch{}try{ed.displayName||(ed.displayName="ErrorMessage")}catch{}try{eu.displayName||(eu.displayName="AgentUnauthorizedError")}catch{}try{ep.displayName||(ep.displayName="AgentErrors")}catch{}var ex=r(65888),em=r(33333),eg=r(97564),ef=r(34614),eb=r(33067),ey=r(19002);function ej({docset:e,size:t}){return(0,n.jsx)(F.r,{src:e.avatarUrl,square:"organization"===e.ownerType,size:t})}try{ej.displayName||(ej.displayName="KnowledgeBaseAvatar")}catch{}var ev=r(16372);function ew({currentTopic:e,indexingState:t,okToIndex:r,triggerIndexing:s}){let[a,l]=(0,h.useState)(!1),[d,u]=(0,h.useState)(!1),[p,m]=(0,h.useState)(!1),g=(0,h.useCallback)(()=>{m(!0),l(!0),s(),(0,G.i)("Indexing requested.")},[s]),f=(0,x.P)(e),b=f?"knowledge base":"repository",y=f?t.docs:t.code;return y===eb.W5.Indexed?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.A,{sx:{px:3,pb:3},children:(0,n.jsx)(eC,{})}),p&&(0,n.jsxs)(o.A,{sx:{borderTop:"1px solid",py:2,borderColor:"border.muted",textAlign:"center"},children:["You indexed this repository.",void 0!==t.remainingRepoIndexTokens&&(0,n.jsx)("span",{className:"color-fg-muted",children:` ${t.remainingRepoIndexTokens} repositories remaining.`})]})]}):(0,n.jsx)(o.A,{className:"indexed-state-container",sx:{display:"flex",flexDirection:"column",alignItems:"center",m:3,mt:0,p:3,gap:3,border:"1px solid",borderColor:"border.default",borderRadius:"6px",textAlign:d?void 0:"center"},children:d?(0,n.jsxs)("div",{className:"d-flex",children:[(0,n.jsx)(k.K,{icon:i.ArrowLeftIcon,onClick:()=>u(!1),"aria-label":"Go back.",variant:"invisible",className:"mr-2",sx:{height:"16px",marginTop:"2px"}}),(0,n.jsxs)("p",{className:"m-0",children:["Under your plan, limited repositories can be concurrently indexed for natural language search."," ",(0,n.jsx)(ef.A,{inline:!0,href:"https://docs.github.com/en/copilot/managing-copilot/managing-github-copilot-in-your-organization/customizing-copilot-for-your-organization/indexing-repositories-for-copilot-chat#about-indexing-repositories",target:"_blank",rel:"noopener noreferrer",children:"Learn more"})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eA,{indexedState:y,canIndexStatus:t.requestStatus,topicType:b,remainingRepoIndexTokens:"repository"===b?t.remainingRepoIndexTokens:void 0}),(0,n.jsxs)("div",{className:"d-flex",children:[r&&(0,n.jsxs)(c.Q,{variant:"primary",onClick:g,disabled:a,className:"mr-2",children:["Index ",e.name]}),t.code!==eb.W5.Unknown&&(0,n.jsx)(c.Q,{onClick:()=>u(!0),children:"Learn more"})]})]})})}function eA({indexedState:e,canIndexStatus:t,topicType:r,remainingRepoIndexTokens:s}){switch(e){case eb.W5.Indexing:return(0,n.jsx)(eS,{topicType:r,remainingRepoIndexTokens:s});case eb.W5.Indexed:return(0,n.jsx)(eC,{});case eb.W5.Unindexed:return(0,n.jsx)(ek,{canIndexStatus:t,topicType:r,remainingRepoIndexTokens:s});default:return(0,n.jsx)(eI,{topicType:r})}}function ek({canIndexStatus:e,topicType:t,remainingRepoIndexTokens:r}){switch(e){case eb.xG.Requested:return(0,n.jsx)(eS,{topicType:t,remainingRepoIndexTokens:r});case eb.xG.RequestFailed:return(0,n.jsxs)(o.A,{sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,n.jsx)(p.A,{icon:i.AlertIcon,size:16,sx:{color:"fg.muted"}}),(0,n.jsx)("div",{children:(0,n.jsx)(u.A,{sx:{ml:2},"aria-live":"polite",children:"Unable to queue for semantic indexing right now \u2014 try again later."})})]});default:return(0,n.jsxs)("div",{className:"d-flex flex-direction-v flex-column",children:[e===eb.xG.CanIndex?(0,n.jsx)("span",{children:`Unlock natural language search and improve Copilot's understanding by indexing this ${t}.`}):(0,n.jsxs)("span",{children:["This ",t," is not currently indexed."]}),void 0!==r&&e!==eb.xG.Forbidden&&(0,n.jsx)("span",{className:"color-fg-muted",children:`${r} repositories remaining.`})]})}}function eS({topicType:e,remainingRepoIndexTokens:t}){return(0,n.jsxs)(o.A,{sx:{display:"flex",gap:1,flexDirection:"column",alignItems:"center"},children:[(0,n.jsxs)("span",{"aria-live":"polite",children:["Copilot is indexing this ",e,"."]}),void 0!==t&&(0,n.jsx)("span",{className:"color-fg-muted",children:`${t} repositories remaining.`}),(0,n.jsxs)("div",{className:"d-flex",children:[(0,n.jsx)(l.A,{size:"small",sx:{color:"fg.muted"}}),(0,n.jsx)("span",{className:"ml-2",children:"This may take a few minutes."})]})]})}function eC(){return(0,n.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(p.A,{icon:i.DotFillIcon,size:16,sx:{color:"success.fg"}}),(0,n.jsx)(o.A,{sx:{color:"fg.muted",fontSize:0,ml:1},children:"Indexed for improved understanding and accuracy."})]})}function eI({topicType:e}){return(0,n.jsxs)(o.A,{sx:{display:"flex",gap:3,alignItems:"center"},children:[(0,n.jsx)(l.A,{size:"small",sx:{color:"fg.muted",flexShrink:0}}),(0,n.jsxs)("span",{children:["Checking for semantic ","repository"===e?"code":""," search availability\u2026"]})]})}try{ew.displayName||(ew.displayName="TopicIndexState")}catch{}try{eA.displayName||(eA.displayName="IndexedStateInfo")}catch{}try{ek.displayName||(ek.displayName="NotIndexedState")}catch{}try{eS.displayName||(eS.displayName="IndexingInProgressState")}catch{}try{eC.displayName||(eC.displayName="IndexedState")}catch{}try{eI.displayName||(eI.displayName="LoadingState")}catch{}function eN(){let{currentTopic:e,mode:t,messages:r}=(0,f.Pk)(),s=(0,x.P)(e),a=(0,x.Z6)(e),l="immersive"===t&&m.W.copilotImmersiveV1,c=e?.name,d=null;e&&a&&(c=d=`${e.ownerLogin}/${e.name}`);let h=s?e.repos:d?[d]:[],[g,b]=(0,eb.M8)(h,s),y=g.requestStatus===eb.xG.CanIndex&&(a&&g.code===eb.W5.Unindexed||s&&g.docs===eb.W5.Unindexed),j=(a&&g.code===eb.W5.Unindexed||s&&g.docs===eb.W5.Unindexed)&&g.requestStatus!==eb.xG.CanIndex,v=a||s,w=(0,n.jsx)("p",{children:"Explore and learn about programming-related concepts using natural language."}),A=(0,n.jsxs)(u.A,{as:"p",sx:{mb:0},children:["Copilot is powered by AI, so mistakes are possible. Review output carefully before use."," ",(0,n.jsx)(ef.A,{inline:!0,href:"https://docs.github.com/en/copilot/github-copilot-enterprise/copilot-chat-in-github/about-github-copilot-chat",target:"_blank",rel:"noopener noreferrer",children:"Learn more about GitHub Copilot Chat."})]}),k=e?s?(0,n.jsxs)("span",{children:[e.description&&(0,n.jsx)("p",{children:e.description}),(0,n.jsxs)("p",{children:["Knowledge bases allow you to chat with Copilot about docs content from multiple repositories using natural language questions like ",(0,n.jsx)("i",{children:'"How do I get started with ___?"'})," or"," ",(0,n.jsx)("i",{children:'"Explain concept ___"'}),"."]}),!l&&A]}):(0,n.jsxs)(n.Fragment,{children:[!m.W.staticThreadSuggestions&&(0,n.jsxs)("p",{children:["You can ask questions like ",(0,n.jsx)("i",{children:'"What does this file do?"'})," or"," ",(0,n.jsx)("i",{children:'"Where is this functionality defined?"'})]}),(0,n.jsx)(u.A,{sx:{mb:0},children:A})]}):(0,n.jsxs)("span",{children:[!l&&w,!l&&A]});return(0,n.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2,color:l?"fg.muted":"fg.default",borderBottom:l?"1px solid var(--borderColor-muted, var(--color-border-muted))":"1px solid var(--borderColor-default, var(--color-border-default))",marginBottom:l?3:0,paddingBottom:l?3:0},children:["immersive"===t&&0===r.length&&(0,n.jsx)(ey.A,{}),(0,n.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[(0,n.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",p:3,pb:0,gap:2},children:[e&&(0,n.jsx)(o.A,{sx:{flexShrink:0},children:s?(0,n.jsx)(ej,{docset:e,size:32}):(0,n.jsx)(ev.W,{ownerLogin:e.ownerLogin,ownerType:e.ownerType,size:32})}),(0,n.jsxs)("div",{children:[!l&&(0,n.jsx)(o.A,{sx:{display:"flex",gap:2},children:(0,n.jsx)(u.A,{as:"h1",sx:{fontSize:2,lineHeight:1.25,wordBreak:"break-word"},children:e?`Chatting about ${c}`:"Chatting about code and programming"})}),(0,n.jsx)(u.A,{sx:{fontSize:0,color:"fg.muted"},children:e&&(s?(0,n.jsxs)("span",{children:[e?.visibleOutsideOrg?"Public":"Private"," knowledge base"]}):(0,n.jsxs)("span",{children:[(0,n.jsx)(u.A,{sx:{textTransform:"capitalize"},children:e?.visibility})," repository"]}))})]})]}),(0,n.jsx)(o.A,{sx:{p:3},children:k}),s&&(0,n.jsxs)(o.A,{sx:{p:3,pt:0},children:[(0,n.jsx)(o.A,{sx:{color:"fg.muted",fontWeight:600,fontSize:0},children:"Repositories included in this knowledge base"}),e.repos.map(e=>(0,n.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",pt:2,pb:2,gap:2},children:[(0,n.jsx)(p.A,{icon:i.RepoIcon,sx:{color:"fg.muted"}}),(0,n.jsx)(ef.A,{href:`/${e}`,sx:{color:"fg.default"},children:e})]},e))]}),v&&(0,n.jsx)(ew,{currentTopic:e,indexingState:g,okToIndex:y,triggerIndexing:b}),j&&(0,n.jsx)(eT,{canIndexStatus:g.requestStatus,currentTopic:e,hitIndividualLimit:void 0!==g.remainingRepoIndexTokens&&g.remainingRepoIndexTokens<=0})]})]})}function eT({canIndexStatus:e,currentTopic:t,hitIndividualLimit:r}){let s;switch(e){case eb.xG.Unauthorized:s=(0,n.jsx)("span",{children:"Ask an organization owner to have this repository indexed for semantic code search."});break;case eb.xG.Unknown:return null;case eb.xG.Forbidden:s=(0,n.jsx)("span",{children:"You can only index repositories that your organization owns."});break;case eb.xG.QuotaExhausted:s=r?(0,n.jsx)("span",{children:"You have reached your semantic search token limit. Please wait for more tokens to be granted."}):(0,n.jsxs)("span",{children:["Your organization has reached its limit for semantic search indexing. Contact your GitHub representative to increase your limit.",(0,eg.G7)("COPILOT_SEMANTIC_CODE_SEARCH_SETTINGS")&&(0,n.jsxs)(n.Fragment,{children:[" ","Organization administrators can"," ",(0,n.jsx)(ef.A,{inline:!0,href:`/organizations/${t.ownerLogin}/settings/copilot/semantic_code_search`,children:"manage indexed repositories"}),"."]})]});break;case eb.xG.ServiceUnavailable:s=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.A,{sx:{fontWeight:600},children:"Indexing temporarily unavailable due to heavy load."}),(0,n.jsx)("span",{children:"Please check back later."})]});break;default:return null}return(0,n.jsx)(o.A,{sx:{p:3,display:"flex",alignItems:"center",gap:2,bg:"canvas.subtle",borderRadius:"0 0 6px 6px",borderTop:"1px solid var(--borderColor-default, var(--color-border-default))"},children:s})}try{eN.displayName||(eN.displayName="TopicIndexedMessage")}catch{}try{eT.displayName||(eT.displayName="CannotIndexReason")}catch{}var eR=r(87726),ez=r(24128);function eW({mode:e}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.A,{sx:{height:"3rem",mb:2,display:"flex",justifyContent:"center"},children:(0,n.jsx)(ez.A,{})}),(0,n.jsx)(d.A,{as:"h1",sx:{textAlign:"center",fontSize:3,mb:2},children:"Ask Copilot"}),(0,n.jsx)(u.A,{as:"p",sx:{textAlign:"center",color:"fg.muted",mb:"immersive"===e?5:3,px:3,textWrap:"balance"},children:"Select a repository to get started. Ask questions about your codebase to get answers fast and learn your way around."})]})}try{eW.displayName||(eW.displayName="ChatWithCopilotHeader")}catch{}var eE=r(70170),eL=r(73766),eD=r(38936),eP=r(56226),eM=r(67749),eG=r(18312);function e$(){let e=(0,b.b)(),{currentRepository:t,mode:r,selectedThreadID:s}=(0,f.Pk)(),[a,c]=(0,h.useState)(""),d=(0,eE.s)(e=>c(e),400,{start:!1}),[p,x]=(0,h.useState)(void 0),m=(0,h.useCallback)(()=>x(void 0),[]),y=(0,h.useCallback)(async(t,n,i)=>{if(m(),!t){e.showTopicPicker(!1),e.clearCurrentTopic(),e.clearCurrentReferences(),"immersive"===r&&window.history.pushState(null,"","/copilot"),s&&g.J.setSelectedTopic(s,null);return}n?(await e.fetchCurrentDocset(t),e.showTopicPicker(!1)):void 0!==i&&(await e.fetchCurrentRepo(Number(i)),e.showTopicPicker(!1))},[m,e,r,s]),{repositories:j,loading:v}=function(e,t,r,s,a,o){let{topRepositoriesCache:l}=(0,f.Pk)(),c=(0,b.b)(),[d,u]=(0,h.useState)([]),[p,x]=(0,h.useState)(!l),m=(0,h.useRef)(void 0),g=(0,eG.useRelayEnvironment)(),y=(0,eG.useFragment)(eD.Sy,r??null);if(y&&!l&&!e){let{topRepositories:e}=y,r=eF((e.edges||[]).flatMap(e=>e?.node?[(0,eG.readInlineData)(eD.R6,e.node)]:[]),t,a),{ownerLogin:l,name:d}=o??{};if(o&&!r.find(e=>e.key===`${l}/${d}`)){let e=o.name;r.splice(0,0,{key:e,actionItem:"workspace"===a?(0,n.jsxs)(O.l.LinkItem,{as:eP.N,to:`/copilot/r/${e}`,onClick:()=>t(e,!1,o.id),children:[(0,n.jsx)(O.l.LeadingVisual,{children:(0,n.jsx)(ev.W,{ownerLogin:o.ownerLogin,ownerType:o.ownerType,size:16})}),o.ownerLogin,"/",e,(0,n.jsx)(O.l.TrailingVisual,{children:(0,n.jsx)(i.ArrowRightIcon,{})})]},e):(0,n.jsxs)(O.l.Item,{onSelect:()=>t(e,!1,o.id),children:[(0,n.jsx)(O.l.LeadingVisual,{children:(0,n.jsx)(ev.W,{ownerLogin:o.ownerLogin,ownerType:o.ownerType,size:16})}),o.ownerLogin,"/",e,(0,n.jsx)(O.l.TrailingVisual,{children:(0,n.jsx)(i.ArrowRightIcon,{})})]},e)})}setTimeout(()=>c.setTopRepositoryTopics(r),10),x(!1),s(void 0)}let j=(0,h.useCallback)(async()=>{try{let e=await (0,eG.fetchQuery)(g,eD.m,{topRepositoriesFirst:4}).toPromise();s(e?.viewer)}catch(e){}finally{x(!1)}},[g,s]);return((0,h.useEffect)(()=>{j()},[j]),(0,h.useEffect)(()=>{let r=async e=>{x(!0);let r=((await new Promise((t,r)=>{(0,eG.fetchQuery)(g,eD.XD,{searchQuery:(0,eL.J)(e)}).subscribe({start:e=>{m.current?.unsubscribe(),m.current=e},next:e=>{t(e)},error:e=>{r(e)}})})).search.nodes||[]).flatMap(e=>e?[(0,eG.readInlineData)(eD.R6,e)]:[]);u(r.length?eF(r,t,a):[]),x(!1)};e?r(e):l&&u(l)},[e,a,t,g,l]),l&&!e)?{repositories:l,loading:!1}:{repositories:d,loading:p}}(a,y,p,x,r,t),w=(0,h.useMemo)(()=>v?"Loading repositories":0===j.length?"No repositories found":1===j.length?"1 repository found":`${j.length} repositories found`,[v,j.length]);return(0,n.jsxs)(o.A,{sx:{border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:2,display:"flex",flexDirection:"column",mb:3},children:[(0,n.jsx)(o.A,{sx:{p:3,pb:0},children:(0,n.jsx)(eM.A,{id:S.uN,leadingVisual:i.SearchIcon,name:"topic-search","aria-label":"Search repositories to chat about",placeholder:"Search repositories to chat about",onChange:e=>d(e.target.value),sx:{width:"100%","input:placeholder-shown":{textOverflow:"ellipsis"}}})}),(0,n.jsxs)(O.l,{children:[(0,n.jsx)("div",{role:"status",className:"sr-only",children:w}),v?(0,n.jsx)(o.A,{as:"li",sx:{display:"flex",justifyContent:"center",py:2,height:"190px",alignItems:"center"},children:(0,n.jsx)(l.A,{})}):0===j.length?(0,n.jsxs)(O.l.Item,{disabled:!0,children:[(0,n.jsx)(O.l.LeadingVisual,{sx:{color:"fg.muted"},children:(0,n.jsx)(i.CircleSlashIcon,{})}),(0,n.jsx)(u.A,{sx:{color:"fg.muted"},children:"No results found"})]}):(0,n.jsx)(n.Fragment,{children:j.length>0&&(0,n.jsxs)(O.l.Group,{children:[(0,n.jsx)(O.l.GroupHeading,{as:"h3",children:"Recent repositories"}),j.map(e=>e.actionItem)]})}),(0,n.jsx)(O.l.Divider,{}),(0,n.jsxs)(O.l.Item,{id:"chat-with-no-context",onSelect:()=>y(void 0),sx:{"#chat-with-no-context--label":{marginBottom:"0px !important"}},children:["General purpose chat",(0,n.jsx)(O.l.TrailingVisual,{children:(0,n.jsx)(i.ArrowRightIcon,{})})]},"chat-with-no-context")]})]})}function eF(e,t,r){return e.map(({owner:{login:e,avatarUrl:s},isInOrganization:a,name:o,databaseId:l})=>{let c=`${e}/${o}`;return{key:c,actionItem:"workspace"===r?(0,n.jsxs)(O.l.LinkItem,{as:eP.N,to:`/copilot/r/${c}`,onClick:()=>t(c,!1,l??0),children:[(0,n.jsx)(O.l.LeadingVisual,{children:(0,n.jsx)(F.r,{src:s,square:a,size:16})}),e,"/",o,(0,n.jsx)(O.l.TrailingVisual,{children:(0,n.jsx)(i.ArrowRightIcon,{})})]},c):(0,n.jsxs)(O.l.Item,{onSelect:()=>t(c,!1,l??0),children:[(0,n.jsx)(O.l.LeadingVisual,{children:(0,n.jsx)(F.r,{src:s,square:a,size:16})}),e,"/",o,(0,n.jsx)(O.l.TrailingVisual,{children:(0,n.jsx)(i.ArrowRightIcon,{})})]},c)}})}try{e$.displayName||(e$.displayName="TopicList")}catch{}let e_=()=>{let e=(0,f.Pk)(),t=(0,h.useMemo)(()=>e.ssoOrganizations?e.ssoOrganizations.map(e=>e.login):[],[e.ssoOrganizations]);return(0,n.jsx)(o.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1,height:"100%"},children:(0,n.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,n.jsx)(eW,{mode:e.mode}),(0,n.jsx)(o.A,{sx:{px:3,"> button":{m:"0 auto"}},children:(0,n.jsx)(e$,{})}),(0,n.jsx)(eR.x,{portalContainerName:em.E5,protectedOrgs:t,redirectURI:()=>`/search/refresh_blackbird_caches?return_to=${location.href}`,sx:{mx:3,mb:3}}),(0,n.jsx)(eB,{currentTopic:e.currentTopic})]})})};function eB({currentTopic:e}){return(0,x.P)(e)?(0,n.jsx)(o.A,{sx:{mt:3,mb:4},children:(0,n.jsx)(eU,{docset:e})}):null}function eU({docset:e}){return(0,n.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",gap:3,border:"1px solid var(--borderColor-default, var(--color-border-default))",borderRadius:"var(--borderRadius-large)",padding:3},children:[(0,n.jsxs)(o.A,{sx:{display:"flex",alignItems:"baseline",gap:2},children:[(0,n.jsx)(ej,{docset:e,size:24}),(0,n.jsx)(d.A,{as:"h3",sx:{fontSize:1,m:0},children:e.name})," ",(0,n.jsx)(u.A,{sx:{fontSize:0,color:"fg.muted"},children:"Knowledge base added to conversation"})]}),(0,n.jsx)(d.A,{as:"h4",sx:{fontSize:0,m:0,color:"fg.muted",fontWeight:"500"},children:"Repositories in this knowledge base"}),(0,n.jsx)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:3},children:e.repos.map(e=>(0,n.jsxs)(o.A,{sx:{whiteSpace:"nowrap"},children:[(0,n.jsx)(i.RepoIcon,{}),` ${e}`]},e))})]})}try{e_.displayName||(e_.displayName="TopicPicker")}catch{}try{eB.displayName||(eB.displayName="TopicDescription")}catch{}try{eU.displayName||(eU.displayName="DocsetDescription")}catch{}let eO=({messages:e,isWaitingOnCopilot:t,inputRef:r,onMessageReceived:s,panelWidth:i})=>{let l=(0,f.Pk)(),{showTopicPicker:c}=l,[d,u]=(0,h.useState)(!0),p=(0,h.useRef)([]),x=m.W.copilotImmersiveV1&&"immersive"===l.mode,g=(0,h.useMemo)(()=>({messages:e,isWaitingOnCopilot:t}),[e,t]),{containerRef:b}=(0,a.G)({focusInStrategy:()=>{let e=document.activeElement;return p.current.includes(e)?e:p.current[p.current.length-1]},focusableElementFilter:e=>!!e.classList.contains("message-container")&&(p.current.includes(e)||p.current.push(e),!0),disabled:!d},[g]),y=l.streamingMessage??e[e.length-1],j=(0,h.useRef)(y?.id),v=(0,h.useRef)(l.currentReferences.length),w=(0,h.useRef)(!!l.suggestions);return(0,h.useEffect)(()=>{j.current!==y?.id||v.current<l.currentReferences.length||y?.error?.isError||!w.current&&l.suggestions?(s({forceScroll:!0}),j.current=y?.id,w.current=!!l.suggestions):s({forceScroll:!1}),v.current=l.currentReferences.length},[j,y?.id,y?.content,y?.error,s,l.currentReferences,l.suggestions]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:"sr-only",children:"Copilot Chat"}),c?(0,n.jsx)(e_,{}):(0,n.jsxs)(o.A,{ref:b,sx:{display:"flex",flexDirection:"column",minHeight:"0",flexGrow:1},children:[(0,n.jsxs)(o.A,{className:"copilot-messages-container",sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[!x&&(0,n.jsx)(eN,{}),e.map((t,s)=>(0,n.jsx)(ec,{isLatestMessage:"assistant"===t.role&&s===e.length-1,message:t,inputRef:r,panelWidth:i,setParentFocusZoneEnabled:u},s)),l.streamingMessage&&(0,n.jsx)(ec,{message:l.streamingMessage,isStreaming:!0,isLatestMessage:!0,panelWidth:i})]}),!c&&l.currentReferences.length>0&&(0,n.jsx)(ex.C,{})]})]})},eH=()=>(0,n.jsxs)(o.A,{sx:{m:"auto",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,n.jsx)(l.A,{size:"large"}),(0,n.jsx)(o.A,{sx:{p:3,color:"fg.subtle"},children:"Loading conversation\u2026"})]}),eK=()=>{let{mode:e,reviewLab:t}=(0,f.Pk)();return(0,n.jsxs)(o.A,{sx:{display:"flex",gap:"2",alignItems:"center",py:3,pr:3,pl:"immersive"===e?3:2,color:"fg.subtle"},children:[(0,n.jsx)(p.A,{icon:i.AlertIcon}),"Failed to load previous messages.",t&&(0,n.jsx)(n.Fragment,{children:"\xa0You are in a review lab. Please check that you are connected to the Developer VPN."})]})},eV=({inputRef:e,panelWidth:t})=>{let r=(0,f.Pk)(),i=(0,b.b)(),{currentReferences:a,messagesLoading:l,threadsLoading:c,currentTopic:d,messages:u,mode:p,selectedThreadID:y,showTopicPicker:j,context:v,scrollToTop:w}=r,A=i.getSelectedThread(r),k=(0,h.useMemo)(()=>eY(Object.keys(eQ)).slice(0,4).map(e=>({heading:e,content:eY(eQ[e])[0]})),[]),S=(0,h.useRef)(null),C=e||S,I=(0,h.useRef)(null),N=(0,h.useRef)(!0),T=(0,h.useRef)(w);(0,h.useEffect)(()=>{A&&u.length>0&&i.showTopicPicker(!1)},[A,u.length,i]),(0,h.useEffect)(()=>{if(!y||"assistive"===p)return;let e=`${x.Jz}/c/${y}`;window.location.pathname!==e&&0!==u.length&&history.pushState(null,"",e)},[y,p,u.length]),(0,h.useEffect)(()=>{let e=d?(0,x.P)(d)?d.name:String(d.id):null,t=async()=>{if(m.W.staticThreadSuggestions)try{let e=await i.createThread();g.J.selectedThreadID=e?.id||null}catch(e){console.error("Failed to create a new thread for suggestions.")}};d&&!y&&t(),y&&d&&g.J.setSelectedTopic(y,e)},[i,y,d]),(0,h.useEffect)(()=>{let e=window.setTimeout(()=>{C.current?.focus()},1);return()=>{window.clearTimeout(e)}},[C]),(0,h.useEffect)(()=>((async()=>{if(!m.W.staticThreadSuggestions||!r.selectedThreadID)return;let e=r.context?.[0]??r.currentTopic;e&&r.selectedThreadID&&await i.generateSuggestions(e,r.selectedThreadID)})(),()=>{i.clearSuggestions()}),[i,r.context,r.currentTopic,r.selectedThreadID]);let R=(0,h.useCallback)(async e=>{T.current=!1,""!==e.trim()&&await i.sendChatMessage(A,e,a,d,v,void 0,r.customInstructions)},[v,a,d,i,r.customInstructions,A]),z=(0,h.useCallback)(e=>{let t=e.target;N.current=1>Math.abs(t.scrollHeight-t.scrollTop-t.clientHeight)},[]),W=(0,h.useCallback)(({forceScroll:e})=>{I.current&&(N.current||e)&&!T.current&&(function(e){return!!e.scrollTo&&"auto"===window.getComputedStyle(e).overflowY}(I.current)?I.current.scrollTo(0,I.current.scrollHeight):window.scrollTo(0,document.body.scrollHeight))},[]),E="loading"===l.state&&r.selectedThreadID&&!j,D="error"===l.state||"error"===c.state,P="loaded"===l.state,M=m.W.copilotImmersiveV1&&"immersive"===r.mode,[G]=(0,h.useState)(r.renderAttachKnowledgeBaseHerePopover),$=!!(!E&&!r.currentTopic&&!j&&0===u.length&&!G&&0===a.length);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.A,{className:"copilot-chat-messages",onScroll:z,ref:I,sx:{overflowY:"auto",overscrollBehavior:"contain",display:"flex",flexDirection:"column",flex:"1 1 auto",scrollbarGutter:"stable"},children:[E&&(0,n.jsx)(eH,{}),D&&(0,n.jsx)(eK,{}),P&&!E&&(0,n.jsx)(eO,{...r,inputRef:C,onMessageReceived:W,panelWidth:t}),(0,n.jsx)(em.Cb,{})]}),$&&(0,n.jsx)(o.A,{className:"copilot-chat-messages",sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,px:3,mb:3,scrollbarGutter:"stable"},children:k.map((e,t)=>(0,n.jsx)(eq,{heading:e.heading,content:e.content,onSubmit:()=>{i.sendChatMessage(i.getSelectedThread(r),e.content,r.currentReferences,r.currentTopic,r.context),(0,s.BI)("copilot_chat_suggestion_click",{topic:r.currentTopic?.name})}},t))}),!E&&!j&&(0,n.jsxs)(o.A,{className:"copilot-chat-input copilot-chat-input-outer",sx:{display:"flex",flexDirection:"column",mt:"auto",px:3,pb:3,zIndex:1},children:[!$&&0===u.length&&!r.showTopicPicker&&(0,n.jsx)(ee.A,{panelWidth:t,suggestionKind:"initial"}),(0,n.jsx)(L,{textAreaRef:C,onSubmit:R,isLoading:r.isWaitingOnCopilot||"loading"===r.slashCommandLoading.state,isStreaming:!!r.streamingMessage,panelWidth:t}),M&&(0,n.jsx)(o.A,{sx:{textAlign:"center",mt:2,color:"fg.subtle",fontSize:"12px"},children:"Copilot can make mistakes. Review output before use."})]}),(0,n.jsx)(em.zc,{})]})};function eq({heading:e,content:t,onSubmit:r}){return(0,n.jsxs)(c.Q,{sx:{bg:"canvas.default",height:"auto",minWidth:"auto",borderBottom:"1px solid",borderColor:"border.default",border:"1px solid var(--borderColor-default, var(--color-border-default))",flex:"1 1 49%",display:"flex",flexDirection:"column",justifyContent:"center",p:2},onClick:r,children:[(0,n.jsx)(d.A,{as:"h3",sx:{textAlign:"center",fontSize:1,m:0,mb:1,wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},children:e}),(0,n.jsx)(u.A,{as:"p",sx:{fontSize:0,fontWeight:400,textAlign:"center",color:"fg.muted",m:0,textWrap:"balance",wordWrap:"break-word",overflowWrap:"break-word",whiteSpace:"normal"},children:t})]})}let eQ={"Languages & frameworks":["Show me Python beginner projects.","Explain Java's garbage collection.","Start me off with Node.js.","Introduce me to Django best practices."],"Tools & environments":["Set up a local development environment.","Demonstrate the basics of Docker.","Get me started with Git.","Recommend popular VS Code extensions."],"Open source & contribution":["Suggest 10 open source projects I can contribute to.","Walk me through the GitHub Pull Request flow.","How do I start my own open source project?","Guide me through contributing to React's codebase."],"Best practices & concepts":["Explain the SOLID principles of object-oriented design.","Introduce me to test-driven development.","Describe common design patterns.","Teach me about RESTful API design."],"Web development":["Guide me through creating a basic website.","Introduce HTML5 and CSS3 features.","Explain responsive web design.","Start me off with Tailwind CSS."],"Databases & data":["Get me started with SQL queries.","Recommend popular NoSQL databases.","How to back up a database?","Give a walkthrough on normalizing a database."],"Algorithms & data structures":["Teach me basic sorting algorithms.","Explain binary search trees.","Introduce me to graph algorithms.","What is a hash table?"],"Security & authentication":["Give a guide on basic web security.","Show me how to set up OAuth.","What's a JSON Web Token?","Describe common encryption techniques."],"Mobile development":["Kickstart my journey with Android development.","Introduce me to iOS app basics.","Recommend cross-platform mobile frameworks.","Give a guide to the app store submission process."],"Cloud & DevOps":["Start me off with AWS basics.","How do I deploy apps on Azure DevOps?","Introduce me to Kubernetes.","What are the basics of continuous integration/continuous deployment?"],"Frontend frameworks & libraries":["Get me started with React.","Walk me through Vue.js essentials.","What are some best practices in Angular development?","How do I use Svelte for web apps?"],"Performance & optimization":["Teach me about website performance optimization.","Explain database indexing benefits.","What are some tips to optimize JavaScript code?","Give a guide to efficient API caching."]};function eY(e){let t=e.slice();for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[r],t[r]=n}return t}try{eO.displayName||(eO.displayName="Messages")}catch{}try{eH.displayName||(eH.displayName="Loading")}catch{}try{eK.displayName||(eK.displayName="Error")}catch{}try{eV.displayName||(eV.displayName="Chat")}catch{}try{eq.displayName||(eq.displayName="SuggestedPrompt")}catch{}},23398:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(74848),s=r(38621),i=r(75177),a=r(38553),o=r(57938);function l(e){let{isLoading:t,isError:r,hasUnreadMessages:l,zIndex:c,fill:d,bg:u,borderColor:p,customIcon:h,mode:x}=e,m=!!o.W.copilotImmersiveV1&&!!x&&"immersive"===x;return(0,n.jsxs)(i.A,{sx:{borderRadius:"100%",position:m?"absolute":"relative",bg:m?"":u||(r?"attention.subtle":"canvas.subtle"),width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",border:m?"":"1px solid",borderColor:m?"":p||(r?"attention.muted":"border.default"),color:d||(t?"accent.fg":m?"fg.muted":"fg.default"),zIndex:c||-1,flexShrink:0,left:m?"-24px":"0",top:m?"21px":"0"},children:[(0,n.jsx)(i.A,{sx:{position:"absolute",display:t?"flex":"none"},children:(0,n.jsx)(a.A,{size:"medium",sx:{width:24,height:24,color:"accent.fg"}})}),l&&(0,n.jsx)(i.A,{className:"unread-indicator",sx:{width:"10px",height:"10px",left:"16px",top:"-2px",borderColor:"canvas.default"}}),h||(0,n.jsx)(s.CopilotIcon,{size:m?24:12}),r?(0,n.jsx)(i.A,{sx:{position:"absolute",bottom:0,right:0,transform:"translate(4px,4px)",color:"attention.fg"},children:(0,n.jsx)(s.AlertFillIcon,{size:12})}):null]})}try{l.displayName||(l.displayName="CopilotBadge")}catch{}},16372:(e,t,r)=>{r.d(t,{W:()=>i});var n=r(74848),s=r(22868);let i=({ownerLogin:e,ownerType:t,size:r})=>(0,n.jsx)(s.r,{src:`/${e}.png?s=40`,square:"Organization"===t,size:r});try{i.displayName||(i.displayName="RepoAvatar")}catch{}},87726:(e,t,r)=>{r.d(t,{x:()=>p});var n=r(74848),s=r(38621),i=r(75177),a=r(65481),o=r(34614),l=r(89323),c=r(16823),d=r(30729),u=r(47767);function p({portalContainerName:e,protectedOrgs:t,redirectURI:r,sx:l}){let c=(0,u.zy)();if(!t||0===t.length)return null;let p=(0,n.jsx)("b",{children:t.slice(0,3).join(", ")});return 2===t.length&&(p=(0,n.jsxs)("span",{children:[(0,n.jsx)("b",{children:t[0]})," and ",(0,n.jsx)("b",{children:t[1]})]})),3===t.length&&(p=(0,n.jsxs)("span",{children:[(0,n.jsx)("b",{children:t.slice(0,2).join(", ")}),", and ",(0,n.jsx)("b",{children:t[2]})]})),(0,n.jsx)(i.A,{sx:l,"data-testid":"sso-banner",children:(0,n.jsx)(i.A,{sx:{fontSize:1},children:(0,n.jsx)("section",{"aria-label":"Single sign on information",children:(0,n.jsx)(a.A,{sx:{p:3,borderRadius:2,borderWidth:1,borderStyle:"solid",borderColor:"accent.muted",fontSize:1},children:1===t.length?(0,n.jsxs)("div",{children:[(0,n.jsx)(d.A,{icon:s.ShieldLockIcon}),(0,n.jsx)(o.A,{inline:!0,href:`/orgs/${t[0]}/sso?return_to=${x({location:c,redirectURI:r})}`,children:"Single sign-on"}),"\xa0to see results in the ",(0,n.jsx)("b",{children:t[0]})," organization."]}):(0,n.jsxs)(i.A,{sx:{display:"flex",alignItems:"baseline",flexWrap:"wrap",gap:2},children:[(0,n.jsxs)(i.A,{sx:{flexGrow:1},children:[(0,n.jsx)(d.A,{icon:s.ShieldLockIcon}),"Single sign on to see results in the ",p," ",t.length>3?`and ${t.length-3} other `:"",t.length>1?"organizations":"organization","."]}),(0,n.jsx)(i.A,{sx:{mt:[2,2,0]},children:(0,n.jsx)(h,{portalContainerName:e,protectedOrgs:t,redirectURI:r})})]})})})})})}function h({portalContainerName:e,protectedOrgs:t,redirectURI:r}){let s=(0,u.zy)();return(0,n.jsxs)(l.W,{children:[(0,n.jsx)(l.W.Button,{size:"small",children:"Select an organization"}),(0,n.jsx)(l.W.Overlay,{portalContainerName:e,children:(0,n.jsx)(c.l,{children:t.map(e=>(0,n.jsx)(c.l.Item,{onSelect:()=>window.location.href=`/orgs/${e}/sso?return_to=${x({location:s,redirectURI:r})}`,children:e},`org-${e}`))})})]})}function x({location:e,redirectURI:t}){return encodeURIComponent(t?t(e):e.pathname+e.search+e.hash)}try{p.displayName||(p.displayName="SingleSignOnBanner")}catch{}try{h.displayName||(h.displayName="SingleSignOnButton")}catch{}}}]);
//# sourceMappingURL=ui_packages_copilot-chat_components_Chat_tsx-c246f59f7485.js.map